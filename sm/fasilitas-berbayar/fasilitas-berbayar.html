<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="shortcut icon" href="../../assets/images/favicon.svg" type="image/x-icon" />
        <title>SM | PlainAdmin Demo</title>

        <!-- ========== All CSS files linkup ========= -->
        <link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
        <link rel="stylesheet" href="../../assets/css/lineicons.css" />
        <link rel="stylesheet" href="../../assets/css/materialdesignicons.min.css" />
        <link rel="stylesheet" href="../../assets/css/fullcalendar.css" />
        <link rel="stylesheet" href="../../assets/css/main.css" />
    </head>

    <body>
        <!-- ======== Preloader =========== -->
        <div id="preloader">
            <div class="spinner"></div>
        </div>
        <!-- ======== Preloader =========== -->

        <!-- ======== sidebar-nav start =========== -->
        <aside class="sidebar-nav-wrapper">
            <div class="navbar-logo">
                <a href="index.html">
                    <img src="../../assets/images/logo/logo.svg" alt="logo" />
                </a>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li class="nav-item">
                        <a href="../index.html">
                            <span class="icon">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M1.66666 4.16667C1.66666 3.24619 2.41285 2.5 3.33332 2.5H16.6667C17.5872 2.5 18.3333 3.24619 18.3333 4.16667V9.16667C18.3333 10.0872 17.5872 10.8333 16.6667 10.8333H3.33332C2.41285 10.8333 1.66666 10.0872 1.66666 9.16667V4.16667Z" />
                                    <path
                                        d="M1.875 13.75C1.875 13.4048 2.15483 13.125 2.5 13.125H17.5C17.8452 13.125 18.125 13.4048 18.125 13.75C18.125 14.0952 17.8452 14.375 17.5 14.375H2.5C2.15483 14.375 1.875 14.0952 1.875 13.75Z" />
                                    <path
                                        d="M2.5 16.875C2.15483 16.875 1.875 17.1548 1.875 17.5C1.875 17.8452 2.15483 18.125 2.5 18.125H17.5C17.8452 18.125 18.125 17.8452 18.125 17.5C18.125 17.1548 17.8452 16.875 17.5 16.875H2.5Z" />
                                </svg>
                            </span>
                            <span class="text">Season</span>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a href="../fasilitas-berbayar/fasilitas-berbayar.html">
                            <span class="icon">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M1.66666 4.16667C1.66666 3.24619 2.41285 2.5 3.33332 2.5H16.6667C17.5872 2.5 18.3333 3.24619 18.3333 4.16667V9.16667C18.3333 10.0872 17.5872 10.8333 16.6667 10.8333H3.33332C2.41285 10.8333 1.66666 10.0872 1.66666 9.16667V4.16667Z" />
                                    <path
                                        d="M1.875 13.75C1.875 13.4048 2.15483 13.125 2.5 13.125H17.5C17.8452 13.125 18.125 13.4048 18.125 13.75C18.125 14.0952 17.8452 14.375 17.5 14.375H2.5C2.15483 14.375 1.875 14.0952 1.875 13.75Z" />
                                    <path
                                        d="M2.5 16.875C2.15483 16.875 1.875 17.1548 1.875 17.5C1.875 17.8452 2.15483 18.125 2.5 18.125H17.5C17.8452 18.125 18.125 17.8452 18.125 17.5C18.125 17.1548 17.8452 16.875 17.5 16.875H2.5Z" />
                                </svg>
                            </span>
                            <span class="text">Fasilitas Berbayar</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../tarif/tarif.html">
                            <span class="icon">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M1.66666 4.16667C1.66666 3.24619 2.41285 2.5 3.33332 2.5H16.6667C17.5872 2.5 18.3333 3.24619 18.3333 4.16667V9.16667C18.3333 10.0872 17.5872 10.8333 16.6667 10.8333H3.33332C2.41285 10.8333 1.66666 10.0872 1.66666 9.16667V4.16667Z" />
                                    <path
                                        d="M1.875 13.75C1.875 13.4048 2.15483 13.125 2.5 13.125H17.5C17.8452 13.125 18.125 13.4048 18.125 13.75C18.125 14.0952 17.8452 14.375 17.5 14.375H2.5C2.15483 14.375 1.875 14.0952 1.875 13.75Z" />
                                    <path
                                        d="M2.5 16.875C2.15483 16.875 1.875 17.1548 1.875 17.5C1.875 17.8452 2.15483 18.125 2.5 18.125H17.5C17.8452 18.125 18.125 17.8452 18.125 17.5C18.125 17.1548 17.8452 16.875 17.5 16.875H2.5Z" />
                                </svg>
                            </span>
                            <span class="text">Tarif</span>
                        </a>
                    </li>
                    <li class="nav-item ">
                        <a href="../customer/customer.html">
                            <span class="icon">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M1.66666 4.16667C1.66666 3.24619 2.41285 2.5 3.33332 2.5H16.6667C17.5872 2.5 18.3333 3.24619 18.3333 4.16667V9.16667C18.3333 10.0872 17.5872 10.8333 16.6667 10.8333H3.33332C2.41285 10.8333 1.66666 10.0872 1.66666 9.16667V4.16667Z" />
                                    <path
                                        d="M1.875 13.75C1.875 13.4048 2.15483 13.125 2.5 13.125H17.5C17.8452 13.125 18.125 13.4048 18.125 13.75C18.125 14.0952 17.8452 14.375 17.5 14.375H2.5C2.15483 14.375 1.875 14.0952 1.875 13.75Z" />
                                    <path
                                        d="M2.5 16.875C2.15483 16.875 1.875 17.1548 1.875 17.5C1.875 17.8452 2.15483 18.125 2.5 18.125H17.5C17.8452 18.125 18.125 17.8452 18.125 17.5C18.125 17.1548 17.8452 16.875 17.5 16.875H2.5Z" />
                                </svg>
                            </span>
                            <span class="text">Customer</span>
                        </a>
                    </li>
                    <li class="nav-item ">
                        <a href="../profile/profile.html">
                            <span class="icon">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M1.66666 4.16667C1.66666 3.24619 2.41285 2.5 3.33332 2.5H16.6667C17.5872 2.5 18.3333 3.24619 18.3333 4.16667V9.16667C18.3333 10.0872 17.5872 10.8333 16.6667 10.8333H3.33332C2.41285 10.8333 1.66666 10.0872 1.66666 9.16667V4.16667Z" />
                                    <path
                                        d="M1.875 13.75C1.875 13.4048 2.15483 13.125 2.5 13.125H17.5C17.8452 13.125 18.125 13.4048 18.125 13.75C18.125 14.0952 17.8452 14.375 17.5 14.375H2.5C2.15483 14.375 1.875 14.0952 1.875 13.75Z" />
                                    <path
                                        d="M2.5 16.875C2.15483 16.875 1.875 17.1548 1.875 17.5C1.875 17.8452 2.15483 18.125 2.5 18.125H17.5C17.8452 18.125 18.125 17.8452 18.125 17.5C18.125 17.1548 17.8452 16.875 17.5 16.875H2.5Z" />
                                </svg>
                            </span>
                            <span class="text">Profile</span>
                        </a>
                    </li>
                    <span class="divider">
                        <hr />
                    </span>


                </ul>
            </nav>

        </aside>
        <div class="overlay"></div>
        <!-- ======== sidebar-nav end =========== -->

        <!-- ======== main-wrapper start =========== -->
        <main class="main-wrapper">
            <!-- ========== header start ========== -->
            <header class="header">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-5 col-md-5 col-6">
                            <div class="header-left d-flex align-items-center">

                                <div class="header-search d-none d-md-flex">
                                    <form onsubmit="event.preventDefault(); getFasilitasBerbayarByName();">
                                        <input type="text" placeholder="Search..." />
                                        <button type="submit">
                                            <i class="lni lni-search-alt"></i>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </header>
            <!-- ========== header end ========== -->

            <!-- ========== table components start ========== -->
            <section class="table-components">
                <div class="container-fluid">
                    <!-- ========== title-wrapper start ========== -->
                    <div class="title-wrapper pt-30">
                        <div class="row align-items-center">
                            <div class="col-md-6">
                                <div class="title">
                                    <h2>Data Fasilitas berbayar</h2>

                                </div>
                            </div>
                            <!-- end col -->
                            <div class="col-md-6">
                                <div class="breadcrumb-wrapper">
                                    <a href="add-fasilitas-berbayar.html" class="main-btn primary-btn-light rounded-full btn-hover">Tambah
                                        Fasilitas Berbayar</a>
                                </div>
                            </div>
                            <!-- end col -->

                        </div>
                        <!-- end row -->
                    </div>
                    <!-- ========== title-wrapper end ========== -->
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card-style mb-30">
                                <!-- <h6 class="mb-10">Data Table</h6>
                                    <p class="text-sm mb-20">
                                        For basic styling—light padding and only
                                        horizontal dividers—use the class table.
                                    </p> -->
                                <div class="table-wrapper table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>
                                                    <h6>Nomor</h6>
                                                </th>
                                                <th>
                                                    <h6>Nama fasilitas</h6>
                                                </th>
                                                <th>
                                                    <h6>Harga(Rp)</h6>
                                                </th>
                                                <th>
                                                    <h6>Action</h6>
                                                </th>

                                            </tr>
                                            <!-- end table row-->
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                    <!-- end table -->
                                </div>
                            </div>
                            <!-- end card -->
                        </div>
                        <!-- end col -->
                    </div>
                    <!-- end row -->
                </div>
                <!-- ========== tables-wrapper end ========== -->
                </div>
                <!-- end container -->
            </section>
            <!-- ========== table components end ========== -->

            <!-- ========== footer start =========== -->
            <footer class="footer">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-6 order-last order-md-first">
                            <div class="copyright text-center text-md-start">
                                <p class="text-sm">
                                    Designed and Developed by
                                    <a href="https://plainadmin.com" rel="nofollow" target="_blank">
                                        PlainAdmin
                                    </a>
                                </p>
                            </div>
                        </div>
                        <!-- end col-->
                        <div class="col-md-6">
                            <div class="terms d-flex justify-content-center justify-content-md-end">
                                <a href="#0" class="text-sm">Term & Conditions</a>
                                <a href="#0" class="text-sm ml-15">Privacy & Policy</a>
                            </div>
                        </div>
                    </div>
                    <!-- end row -->
                </div>
                <!-- end container -->
            </footer>
            <!-- ========== footer end =========== -->
        </main>
        <!-- ======== main-wrapper end =========== -->

        <!-- ========= All Javascript files linkup ======== -->
        <script src="../../assets/js/bootstrap.bundle.min.js"></script>
        <script src="../../assets/js/Chart.min.js"></script>
        <script src="../../assets/js/dynamic-pie-chart.js"></script>
        <script src="../../assets/js/moment.min.js"></script>
        <script src="../../assets/js/fullcalendar.js"></script>
        <script src="../../assets/js/jvectormap.min.js"></script>
        <script src="../../assets/js/world-merc.js"></script>
        <script src="../../assets/js/polyfill.js"></script>
        <script src="../../assets/js/main.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <script src="../../index.js"></script>

        <script>
            let listFasilitasBerbayar = [];
            const tBody = document.querySelector('tbody');
            window.onload = getFasilitasBerbayar();
            

            async function getFasilitasBerbayar() {
                await axios(
                    {
                        method: "get",
                        url: url + "fasilitasberbayar",
                        headers: {
                            Authorization : "Bearer " + localStorage.getItem("token")
                        }
                    },
                    document.body.classList.add("loading-indicator")
                )
                    .then((result) => {
                        document.body.classList.remove("loading-indicator");
                        listFasilitasBerbayar = []
                        fasilitasBerbayar = result.data.data;
                        fasilitasBerbayar.forEach(element => {
                            listFasilitasBerbayar.push(element);

                        });
                        const tableData = listFasilitasBerbayar.map((item, index) => {
                            return `
                                <tr>
                                    <td>${index+1}</td>
                                    <td>${item.nama_fasilitas}</td>
                                    <td>${item.harga}</td>
                                    <td>
                                        <div class="action">
                                            <button class="text-success" onclick="redirectToUpdatePage(${item.id})">
                                                <i class="mdi mdi-update"></i>
                                            </button>
                                            <button class="text-danger" onclick="deleteFasilitasBerbayar(${item.id})">
                                                <i class="lni lni-trash-can"></i>
                                            </button>
                                        </div>    
                                    </td>
                                </tr>
                                `;
                        }).join("");
                        tBody.innerHTML = tableData;

                    })
                    .catch((err) => {
                        document.body.classList.remove("loading-indicator");
                        alert(err.response.data.message);
                        if(err.response.status == 403 ){
                            window.location.href = "../../auth/signin.html";
                            localStorage.clear();
                        }
                        return Promise.reject(err);
                    });
            }

            async function getFasilitasBerbayarByName() {

                let namaFasilitasBerbayar = document.querySelector('input[type="text"]').value;

                if(namaFasilitasBerbayar == ""){
                    await getFasilitasBerbayar();
                    return;
                }

                await axios(
                    {
                        method: "get",
                        url: url + "fasilitasberbayar/search?name=" + namaFasilitasBerbayar,
                        headers: {
                            Authorization : "Bearer " + localStorage.getItem("token")
                        }
                    },
                    document.body.classList.add("loading-indicator")
                )
                    .then((result) => {
                        document.body.classList.remove("loading-indicator");
                        listFasilitasBerbayar = []
                        fasilitasBerbayar = result.data.data;
                        fasilitasBerbayar.forEach(element => {
                            listFasilitasBerbayar.push(element);

                        });
                        const tableData = listFasilitasBerbayar.map((item, index) => {
                            return `
                                <tr>
                                    <td>${index+1}</td>
                                    <td>${item.nama_fasilitas}</td>
                                    <td>${item.harga}</td>
                                    <td>
                                        <div class="action">
                                            <button class="text-success" onclick="redirectToUpdatePage(${item.id})">
                                                <i class="mdi mdi-update"></i>
                                            </button>
                                            <button class="text-danger" onclick="deleteFasilitasBerbayar(${item.id})">
                                                <i class="lni lni-trash-can"></i>
                                            </button>
                                        </div>    
                                    </td>
                                </tr>
                                `;
                        }).join("");
                        tBody.innerHTML = tableData;

                    })
                    .catch((err) => {
                        document.body.classList.remove("loading-indicator");
                        if(err.response.status == 403 ){
                            window.location.href = "../auth/signin.html";
                            localStorage.clear();
                        }
                        if(err.response.status == 404 ){
                            alert("Data tidak ditemukan")
                        }
                        return Promise.reject(err);
                    });
            }

            function redirectToUpdatePage(id) {
                params = new URLSearchParams()
                params.append("id", id);
                window.location.href = "./update-fasilitas-berbayar.html?" + params.toString();
            }

            async function deleteFasilitasBerbayar(id) {
                await axios(
                    {
                        method: "delete",
                        url:  url + "fasilitasberbayar/" + id,
                        headers: {
                            Authorization : "Bearer " + localStorage.getItem("token")
                        }

                    },
                    document.body.classList.add("loading-indicator")
                )
                    .then((result) => {
                        document.body.classList.remove("loading-indicator");
                        alert("Berhasil hapus fasilitas berbayar");
                        window.location.reload();

                    })
                    .catch((err) => {
                        document.body.classList.remove("loading-indicator");
                        alert(err.response.data.message);
                        if(err.response.status == 403 ){
                            window.location.href = "../auth/signin.html";
                            localStorage.clear();
                        }
                        return Promise.reject(err);
                    });
            }

        </script>

    </body>

</html>